<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>8BitDits Music</title>
  <link rel="icon" href="music/play-pause-button.png" type="image/png"/>
  <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
  <style>
    body {
      image-rendering: pixelated;
      background-color: #825f80;
      color: black;
      font-family: 'VT323', monospace;
      margin: 0;
      padding: 0;
    }

    .jukebox {
      position: fixed;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1;
      background: #cfa9cc;
      width: 100%;
      text-align: center;
      padding: 0px 0;
      border-bottom: 4px solid #000;
      cursor: pointer; /* show clickable */
    }

    .jukebox-image {
      display: block;
      margin: 20px auto 0 auto;
      pointer-events: none;
    }

    .music-image {
      width: 150px;
      cursor: grab;
      user-select: none;
      position: absolute;
    }

    #dragItem { left: 50px; top: 250px; }
    #dragItem2 { left: 50px; top: 450px; }

    #dropTarget {
      position: fixed;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      z-index: 1;
      pointer-events: auto; /* allow clicks */
    }

    .song-label {
      position: absolute;
      font-size: 20px;
      color: black;
    }

    #label1 { left: 220px; top: 290px; }
    #label2 { left: 220px; top: 490px; }
  </style>
</head>
<body>

  <!-- Jukebox Header -->
  <div class="jukebox" id="dropTarget">
    <img src="images/8bitdits-jukebox.png" class="jukebox-image" alt="JukeboxImage">
  </div>

  <!-- Music Buttons -->
    <!-- disc 1 -->
  <img src="music/8BD CD website.png" class="music-image" id="dragItem" alt="MusicButton1" draggable="false">
    <!-- disc 2 -->
  <img src="music/8BD CD website.png" class="music-image" id="dragItem2" alt="MusicButton2" draggable="false">

  <!-- Labels -->
  <p id="label1" class="song-label">Test Song 1</p>
  <p id="label2" class="song-label">Test Song 2</p>

  <!-- Audio Elements -->
  <audio id="song1">
    <source src="music/test-song1.wav" type="audio/wav">
  </audio>
  <audio id="song2">
    <source src="music/test-song2.wav" type="audio/wav">
  </audio>

  <script>
    const dropTarget = document.getElementById("dropTarget");
    const allButtons = [
      { button: document.getElementById("dragItem"), song: document.getElementById("song1") },
      { button: document.getElementById("dragItem2"), song: document.getElementById("song2") }
    ];

    let currentSong = null;
    let currentButton = null;

    function makeDraggable(dragItem, song) {
      let isDragging = false;
      let offsetX = 0;
      let offsetY = 0;

      const startLeft = dragItem.offsetLeft;
      const startTop = dragItem.offsetTop;

      dragItem.addEventListener("mousedown", (e) => {
        e.preventDefault();
        isDragging = true;
        dragItem.style.cursor = "grabbing";

        offsetX = e.clientX - dragItem.offsetLeft;
        offsetY = e.clientY - dragItem.offsetTop;
      });

      document.addEventListener("mousemove", (e) => {
        if (!isDragging) return;
        dragItem.style.left = (e.clientX - offsetX) + "px";
        dragItem.style.top  = (e.clientY - offsetY) + "px";
      });

      document.addEventListener("mouseup", () => {
        if (!isDragging) return;
        isDragging = false;
        dragItem.style.cursor = "grab";

        const dragRect = dragItem.getBoundingClientRect();
        const dropRect = dropTarget.getBoundingClientRect();

        const isOver =
          dragRect.right  > dropRect.left &&
          dragRect.left   < dropRect.right &&
          dragRect.bottom > dropRect.top &&
          dragRect.top    < dropRect.bottom;

        if (isOver) {
          // Stop other songs
          allButtons.forEach(item => {
            if (item.song !== song) {
              item.song.pause();
              item.song.currentTime = 0;
              item.button.src = "music/8BD CD website.png";
            }
          });

          // Play selected song
          song.currentTime = 0;
          song.play();
          dragItem.src = "music/8BD CD empty website.png";

          currentSong = song;
          currentButton = dragItem;

          song.onended = () => {
            dragItem.src = "music/8BD CD empty website.png";
            if (currentSong === song) {
              currentSong = null;
              currentButton = null;
            }
          };
        }

        // Reset button position
        dragItem.style.left = startLeft + "px";
        dragItem.style.top  = startTop + "px";
      });
    }

    // Initialize draggable buttons
    allButtons.forEach(item => makeDraggable(item.button, item.song));

    // Jukebox toggle play/pause
    dropTarget.addEventListener("click", () => {
      if (currentSong) {
        if (!currentSong.paused) {
          currentSong.pause();
          currentButton.src = "music/8BD CD website.png";
        } else {
          currentSong.play();
          currentButton.src = "music/8BD CD empty website.png";
        }
      }
    });
  </script>

</body>
</html>
