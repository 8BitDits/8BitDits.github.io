<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>8BitDits Music</title>
  <link rel="icon" href="music/play-pause-button.png" type="image/png"/>
  <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
  <style>
    body {
      image-rendering: pixelated;
      background-color: #825f80;
      color: black;
      font-family: 'VT323', monospace;
      margin: 0;
      padding: 0;
    }

    /* Jukebox Header */
    .jukebox {
      position: fixed;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1;
      background: #cfa9cc;
      width: 100%;
      text-align: center;
      padding: 0px 0;
      border-bottom: 4px solid #000;
      cursor: pointer;
    }

    .jukebox-image {
      display: block;
      margin: 20px auto 0 auto;
      pointer-events: none;
    }

    /* Volume slider container */
    #volumeContainer {
      position: fixed;
      top: 140px;
      right: 20%;
      transform: translateX(-50%);
      z-index: 2;
      text-align: center;
    }

    #volumeControl {
    -webkit-appearance: none;  /* remove default styling */
    width: 200px;
    height: 10px;
    background: #a883a5;          /* track background */
    border-radius: 0px;
    margin-top: 0px;
    }

    /* Filled part of the slider (Webkit browsers) */
    #volumeControl::-webkit-slider-runnable-track {
      height: 10px;
      border-radius: 0px;
    }

    /* The thumb */
    #volumeControl::-webkit-slider-thumb {
      appearance: none;
      width: 20px;
      height: 20px;
      background: #4f354d;
      border-radius: 50%;
      cursor: pointer;
      border: 2px solid black;
      margin-top: -5px; /* center thumb on track */
    }

    /* Music disc images (left) */
    .music-disc-image {
      width: 150px;
      left: 30vw;
      cursor: grab;
      user-select: none;
      position: absolute;
    }
    /* adjust heights of discs */
    #dragItem { top: 250px;}
    #dragItem2 { top: 450px; }

    /* Music images (right) */
    .music-picture {
      position: fixed;
      width: 300px;
      border: 4px solid black;
      right: 20vw;
    }
    /* adjust heights of music pics */
    #musicPic1 { top: 250px; }
    #musicPic2 { top: 450px; }

    #dropTarget {
      position: fixed;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      z-index: 1;
      pointer-events: auto;
    }

    /* Labels (centered between left and right) */
    .song-label {
      position: fixed;
      font-size: 20px;
      color: black;
      font-family: 'VT323', monospace;
      width: 300px;
      text-align: center;
      left: 50%;
      transform: translateX(-50%);
    }
    /* adjust heights of disc labels */
    #label1 { top: 300px; }
    #label2 { top: 500px; }
    
  </style>
</head>
<body>

  <!-- Jukebox Header -->
  <div class="jukebox" id="dropTarget">
    <img src="images/8bitdits-jukebox.png" class="jukebox-image" alt="JukeboxImage">
  </div>

  <!-- Music Discs (left) -->
  <img src="music/8BD CD website.png" class="music-disc-image" id="dragItem" alt="MusicButton1" draggable="false">
  <img src="music/8BD CD website.png" class="music-disc-image" id="dragItem2" alt="MusicButton2" draggable="false">

  <!-- Music Images (right) -->
  <img src="music/demo pic.png" class="music-picture" id="musicPic1">
  <img src="music/demo pic.png" class="music-picture" id="musicPic2">

  <!-- Labels (centered) -->
  <p id="label1" class="song-label">Description for Song 1</p>
  <p id="label2" class="song-label">Description for Song 2</p>

  <!-- Audio Elements -->
  <audio id="song1">
    <source src="music/test-song1.wav" type="audio/wav">
  </audio>
  <audio id="song2">
    <source src="music/test-song2.wav" type="audio/wav">
  </audio>

  <!-- Volume Slider -->
  <div id="volumeContainer">
    <label for="volumeControl">Volume</label><br>
    <input type="range" id="volumeControl" min="0" max="1" step="0.01" value="0.5">
  </div>

  <script>
    const dropTarget = document.getElementById("dropTarget");
    const allButtons = [
      { button: document.getElementById("dragItem"), song: document.getElementById("song1") },
      { button: document.getElementById("dragItem2"), song: document.getElementById("song2") }
    ];

    let currentSong = null;
    let currentButton = null;
    const volumeControl = document.getElementById("volumeControl");

    function makeDraggable(dragItem, song) {
      let isDragging = false;
      let offsetX = 0;
      let offsetY = 0;

      const startLeft = dragItem.offsetLeft;
      const startTop = dragItem.offsetTop;

      dragItem.addEventListener("mousedown", (e) => {
        e.preventDefault();
        isDragging = true;
        dragItem.style.cursor = "grabbing";
        offsetX = e.clientX - dragItem.offsetLeft;
        offsetY = e.clientY - dragItem.offsetTop;
      });

      document.addEventListener("mousemove", (e) => {
        if (!isDragging) return;
        dragItem.style.left = (e.clientX - offsetX) + "px";
        dragItem.style.top  = (e.clientY - offsetY) + "px";
      });

      document.addEventListener("mouseup", () => {
        if (!isDragging) return;
        isDragging = false;
        dragItem.style.cursor = "grab";

        const dragRect = dragItem.getBoundingClientRect();
        const dropRect = dropTarget.getBoundingClientRect();

        const isOver =
          dragRect.right  > dropRect.left &&
          dragRect.left   < dropRect.right &&
          dragRect.bottom > dropRect.top &&
          dragRect.top    < dropRect.bottom;

        if (isOver) {
          // Stop other songs and reset buttons
          allButtons.forEach(item => {
            if (item.song !== song) {
              item.song.pause();
              item.song.currentTime = 0;
              item.button.src = "music/8BD CD website.png";
            }
          });

          // Play selected song
          song.currentTime = 0;
          song.volume = volumeControl.value;
          song.play();
          dragItem.src = "music/8BD CD empty website.png";
          currentSong = song;
          currentButton = dragItem;

          song.onended = () => {
            dragItem.src = "music/8BD CD website.png";
            if (currentSong === song) {
              currentSong = null;
              currentButton = null;
            }
          };
        }

        // Reset button position immediately (no slow animation)
        dragItem.style.left = startLeft + "px";
        dragItem.style.top  = startTop + "px";
      });
    }

    // Initialize draggable buttons
    allButtons.forEach(item => makeDraggable(item.button, item.song));

    // Jukebox click toggle play/pause
    dropTarget.addEventListener("click", () => {
      if (currentSong) {
        if (!currentSong.paused) {
          currentSong.pause();
          currentButton.src = "music/8BD CD website.png";
        } else {
          currentSong.play();
          currentButton.src = "music/8BD CD empty website.png";
        }
      }
    });

    // Volume control
    volumeControl.addEventListener("input", () => {
      if (currentSong) {
        currentSong.volume = volumeControl.value;
      }
    });
  </script>

</body>
</html>
